<!DOCTYPE html>
<html lang="zh">
<head><meta name="generator" content="Hexo 3.9.0">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="renderer" content="webkit|ie-comp|ie-stand">
    <meta name="referrer" content="no-referrer">
    <meta name="theme-color" content="#333333">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="google" content="notranslate">
    <meta name="format-detection" content="telephone=no">
    <meta name="description" content="随便写点啥。">
    <meta name="keyword" content="Web, Flutter, Js, CSS, Node.js, Frontend">
    <title>理解 Flutter 应用和部件的生命周期 - 冷石的博客</title>
    <base href="/">
    <link rel="manifest" href="/manifest.json">
    <link rel="shortcut icon" href="/images/favicon.ico">
    <link rel="preconnect" href="https://cdn.bootcss.com">
    <link rel="stylesheet" href="/styles/aircloud.css">
    <link href="//at.alicdn.com/t/font_620856_pl6z7sid89qkt9.css" rel="stylesheet" type="text/css">
    <noscript>
      <p class="text-center">你的浏览器还没开启 Javascript 功能！</p>
    </noscript>
</head>

<body>
    <div class="site-nav-toggle" id="site-nav-toggle">
        <button>
            <span class="btn-bar"></span>
            <span class="btn-bar"></span>
            <span class="btn-bar"></span>
        </button>
    </div>

    <main class="index-container">
        
            <section class="index-left">
                <div class="nav" id="nav">
  <nav class="contents" id="nav-content">
      <ul>
          <li >
              <a href="/">
                  <i class="iconfont icon-shouye1"></i>
                  <span>主页</span>
              </a>
          </li>
          <li >
              <a href="/tags">
                  <i class="iconfont icon-biaoqian1"></i>
                  <span>标签</span>
              </a>
          </li>
          <li >
              <a href="/archives">
                  <i class="iconfont icon-guidang2"></i>
                  <span>存档</span>
              </a>
          </li>
          <li >
              <a href="/about/">
                  <i class="iconfont icon-guanyu2"></i>
                  <span>关于</span>
              </a>
          </li>
          
          <li>
              <a id="search">
                  <i class="iconfont icon-sousuo1"></i>
                  <span>搜索</span>
              </a>
          </li>
          
      </ul>
  </nav>
</div>

<div class="search-field" id="search-field">
    <div class="search-container">
        <div class="search-input">
            <span id="esc-search"> <i class="icon-fanhui iconfont"></i></span>
            <input id="search-input"/>
            <span id="begin-search">搜索</span>
        </div>
        <div class="search-result-container" id="search-result-container"></div>
    </div>
</div>

            </section>
        
        <section class="index-middle flex"><div class="post-container">
    <div class="post-title">
        理解 Flutter 应用和部件的生命周期
    </div>

    <div class="post-meta">
      <span class="attr">发布于：<span>2019-07-28 13:21:03</span></span>
        
        <span class="attr">标签：/
        
        <a class="tag" href="/tags/#Flutter" title="Flutter">Flutter</a>
        <span>/</span>
        
        
        </span>
        <span class="attr">访问：<span id="busuanzi_value_page_pv"></span></span>
      </span>
    </div>

    <div class="post-content no-indent">
        <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>在 Flutter 里面部件以及应用本身都有自己的生命周期，本文分别说明它们的生命周期</p>
<h2 id="部件"><a href="#部件" class="headerlink" title="部件"></a>部件</h2><p>在 Flutter 里面有两种部件 StatefulWidget 和 StatelessWidget，它们的生命周期分别是</p>
<h3 id="StatelessWidget"><a href="#StatelessWidget" class="headerlink" title="StatelessWidget"></a>StatelessWidget</h3><p>无状态部件的生命周期很简单，首先执行构造函数然后就执行 build 方法了</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Constructor Function</span><br><span class="line"></span><br><span class="line">build()</span><br></pre></td></tr></table></figure>

<h3 id="StatefulWidget"><a href="#StatefulWidget" class="headerlink" title="StatefulWidget"></a>StatefulWidget</h3><p>有状态部件的生命周期会复杂一些，因为是多了状态变化。首先是构造函数，然后会初始化 State 在执行 build 方法，如果执行了 setState 方法，就要检查部件是否更新，在执行 build，最后部件销毁的时候执行 dispose 方法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">Constructor Function</span><br><span class="line"></span><br><span class="line">initState()</span><br><span class="line"></span><br><span class="line">build()</span><br><span class="line"></span><br><span class="line">setState()</span><br><span class="line"></span><br><span class="line">didUpdateWidget()</span><br><span class="line"></span><br><span class="line">build()</span><br><span class="line"></span><br><span class="line">dispose()</span><br></pre></td></tr></table></figure>

<h2 id="应用"><a href="#应用" class="headerlink" title="应用"></a>应用</h2><p>Flutter 应用本身也有自己的生命周期，要观察到这些状态的变化需要让一个有状态部件混入 <code>WidgetsBindingObserver</code>，然后在 <code>initState</code> 方法中创建一个观察者，当然部件销毁的时候需要把创建的观察者实现清除</p>
<ul>
<li><p>inactive 应用处于非活动状态，并且未接收用户输入</p>
</li>
<li><p>paused 应用当前对用户不可见，不响应用户输入，并在后台运行</p>
</li>
<li><p>resumed 应用可见并响应用户输入</p>
</li>
<li><p>suspending 应用退出了</p>
</li>
</ul>
<p>代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">class MyApp extends StatelessWidget &#123;</span><br><span class="line">  @override</span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    return MaterialApp(</span><br><span class="line">      title: &apos;Flutter Lifecycle&apos;,</span><br><span class="line">      home: MyHomePage(),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class MyHomePage extends StatefulWidget &#123;</span><br><span class="line">  @override</span><br><span class="line">  _MyHomePageState createState() =&gt; _MyHomePageState();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class _MyHomePageState extends State&lt;MyHomePage&gt; with WidgetsBindingObserver &#123;</span><br><span class="line">  @override</span><br><span class="line">  void initState() &#123;</span><br><span class="line">    WidgetsBinding.instance.addObserver(this);</span><br><span class="line">    super.initState();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  @override</span><br><span class="line">  void didChangeAppLifecycleState(AppLifecycleState state) &#123;</span><br><span class="line">	print(state);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  @override</span><br><span class="line">  void dispose() &#123;</span><br><span class="line">    WidgetsBinding.instance.removeObserver(this);</span><br><span class="line">    super.dispose();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  @override</span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    return Scaffold();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>可以看到在 Flutter 应用里面这些生命周期还是挺简单易懂的</p>

        <div id="comment-container"></div>
        <div id="disqus_thread"></div>
        <div id="lv-container"></div>
    </div>

</div>
<div id="toc" class="toc-article">
  <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#前言"><span class="toc-number">1.</span> <span class="toc-text">前言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#部件"><span class="toc-number">2.</span> <span class="toc-text">部件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#StatelessWidget"><span class="toc-number">2.1.</span> <span class="toc-text">StatelessWidget</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#StatefulWidget"><span class="toc-number">2.2.</span> <span class="toc-text">StatefulWidget</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#应用"><span class="toc-number">3.</span> <span class="toc-text">应用</span></a></li></ol>
</div>

</section>
    </main>
    <footer class="footer"></footer>

</body>

<script>
    window.hexo_search_path = "search.json"
    window.hexo_root = "/"
    window.isPost = true
</script>
<script src="/scripts/index.js"></script>
<script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script>
<script src=https://www.googletagmanager.com/gtag/js?id=UA-119658292-2"></script>

    <script type="text/javascript">
       (function() {
           if (typeof LivereTower === 'function') { return; }

           var j, d = document.getElementById('lv-container');

           d.setAttribute('data-id','city');
           d.setAttribute('data-uid' , 'MTAyMC80NTY4Mi8yMjE5Mw==');

           j = document.createElement('script');
           j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
           j.async = true;

           d.appendChild(j);
       })();
    </script>
    <noscript>为正常使用来必力评论功能请激活JavaScript</noscript>
    </div>

</html>
